var rowData=document.getElementById("rowData");var contactName=document.getElementById("contactName");var contactEmail=document.getElementById("contactEmail");var contactPhone=document.getElementById("contactPhone");var contactAddress=document.getElementById("adress");var contactGroup=document.getElementById("group");var contactDescription=document.getElementById("description");var contactFavourateCheck=document.getElementById("favourateCheck");var contactEmergencyCheck=document.getElementById("emergencyCheck");var close=document.getElementById("close");var totalContacts=document.getElementById("totalContacts");var totalFavourates=document.getElementById("favouriteContacts");var totalEmergencies=document.getElementById("emergencyContacts");var favourateContactCards=document.getElementById("favourate-contact-cards");var emergencyContactCards=document.getElementById("emergency-contact-cards");var numberOfContactsSearch=document.getElementById("NCS");var saveContact=document.getElementById("saveContact");var updateContact=document.getElementById("updateContact");var allContacts=JSON.parse(localStorage.getItem("contacts"))||[];function updateUI(){displayContacts();displayTotalContacts();displayFavorates();displayEmergencies()}
updateUI();function displayTotalContacts(){totalContacts.innerHTML=allContacts.length;totalFavourates.innerHTML=countFavourates();totalEmergencies.innerHTML=countEmergencies();numberOfContactsSearch.innerHTML=allContacts.length};function countFavourates(){var favourates=0;for(var i=0;i<allContacts.length;i++){if(allContacts[i].favourate){favourates++}}
return favourates}
function countEmergencies(){var emergencies=0;for(var i=0;i<allContacts.length;i++){if(allContacts[i].emergency){emergencies++}}
return emergencies}
function generatePhoneNumberQR(){const phoneNumberInput=document.getElementById("phoneNumber");const phoneNumber=phoneNumberInput.value.trim();if(validateAllInputs(phoneNumberInput)){const qrcodeContainer=document.getElementById("qrcode-container");qrcodeContainer.innerHTML="";const qrCodeData=`tel:${phoneNumber}`;new QRCode(qrcodeContainer,{text:qrCodeData,width:128,height:128,colorDark:"#000000",colorLight:"#ffffff",correctLevel:QRCode.CorrectLevel.H})}else{const qrcodeContainer=document.getElementById("qrcode-container");qrcodeContainer.innerHTML="";Swal.fire({title:"Please enter a valid phone number",icon:"warning",draggable:!0,})}}
function callPhoneNumber(){const phoneNumberInput=document.getElementById("phoneNumber");const phoneNumber=phoneNumberInput.value.trim();if(validateAllInputs(phoneNumberInput)){window.location.href=`tel:${phoneNumber}`}else{Swal.fire({title:"Please enter a valid phone number",icon:"warning",draggable:!0,})}}
function addNewContact(){var newContact={name:contactName.value,phone:contactPhone.value,email:contactEmail.value,address:contactAddress.value,group:contactGroup.value,description:contactDescription.value,favourate:contactFavourateCheck.checked,emergency:contactEmergencyCheck.checked,};var validName=validateAllInputs(contactName);var validPhone=validateAllInputs(contactPhone);var validEmail=validateAllInputs(contactEmail);if(validName&&validPhone&&(contactEmail.value==""||validEmail)){if(checkRepeatedContact(newContact.phone)){Swal.fire({title:"Contact already exists",icon:"warning",draggable:!0,})}else{allContacts.push(newContact);localStorage.setItem("contacts",JSON.stringify(allContacts));clearAllInputFields();Swal.fire({title:"Saved Successfully",icon:"success",draggable:!0,});var exampleModalScrollable=document.getElementById("exampleModalScrollable");var modal=bootstrap.Modal.getInstance(exampleModalScrollable);modal.hide();updateUI()}}else if(contactName.value==""||contactPhone.value==""){Swal.fire({title:"Please Fill All Required Fields",icon:"warning",draggable:!0,})}else if(!validName||!validPhone||!validEmail){Swal.fire({title:"Please enter a valid data in all required fields",icon:"warning",draggable:!0,})}}
function checkRepeatedContact(phone){for(var i=0;i<allContacts.length;i++){if(allContacts[i].phone==phone){return!0}}
return!1}
function clearAllInputFields(){contactName.value="";contactPhone.value="";contactEmail.value="";contactAddress.value="";contactGroup.value="";contactDescription.value="";contactFavourateCheck.checked=!1;contactEmergencyCheck.checked=!1;contactName.classList.remove("is-invalid");contactPhone.classList.remove("is-invalid");contactEmail.classList.remove("is-invalid");contactName.classList.remove("is-valid");contactPhone.classList.remove("is-valid");contactEmail.classList.remove("is-valid")}
function checkEmail(email){if(email){return `<div class="icon-email">
                    <p class="mb-0 fs-7 my-text-gray-500 d-flex gap-2 align-items-center">
                        <span class="my-text-indigo-600 my-bg-indigo-200 icon-size d-flex align-items-center justify-content-center p-1 rounded">
                            <i class="fa-solid fa-envelope fa-sm"></i>
                        </span>
                        <span>${email}</span>
                    </p>
                </div>`}else{return""}}
function checkAddress(address){if(address){return `<div class="icon-address">
                    <p class="mb-0 fs-7 my-text-gray-500 d-flex gap-2 align-items-center">
                        <span class="my-text-green-700 my-bg-green-200 icon-size d-flex align-items-center justify-content-center p-1 rounded">
                            <i class="fa-solid fa-location-dot fa-sm"></i>
                        </span>
                        <span>${address}</span>
                    </p>
                </div>`}else{return""}}
function checkStar(star){if(star){return `<span id="star" class="my-text-white my-bg-amber-400 rounded-circle icon-size-2 position-absolute top-right d-flex align-items-center justify-content-center">
                    <i class="fa-solid fa-star fa-2xs"></i>
                </span>`}else{return""}}
function checkHeart(emergency){if(emergency){return `<span id="heart" class="my-text-white my-bg-red-500 rounded-circle icon-size-2 position-absolute bottom-right d-flex align-items-center justify-content-center">
                    <i class="fa-solid fa-heart-pulse fa-2xs"></i>
                </span>`}else{return""}}
function checkGroup(group){if(group&&group!="Select Group"){return `
        <span class="my-text-indigo-600 my-bg-indigo-200 d-flex align-items-center justify-content-center p-1 rounded fs-7">${group}</span>
        `}else{return""}}
function checkEmergency(emergency){if(emergency){return `
        <span class="my-text-red-500 my-bg-red-200 d-flex align-items-center justify-content-center p-1 rounded fs-7">
            <span>
                <i class="fa-solid fa-heart-pulse fa-sm"></i>
            </span>
            Emergency
        </span>
        `}else{return""}}(function checkContacts(){var contactsBox="";if(allContacts.length==0){contactsBox=`
            <div class="no-contacts p-4">
                <p class="mb-0 fs-7 my-text-gray-500 text-center">No Contacts Yet</p>
            </div>`;rowData.innerHTML=contactsBox;return}
displayContacts()})();function displayFavorates(){var favouratesBox="";if(countFavourates()==0){favouratesBox=`
            <div class="no-favourates p-4">
                <p class="mb-0 fs-7 my-text-gray-500 text-center">No Favourates Contacts Yet</p>
            </div>`;favourateContactCards.innerHTML=favouratesBox;return}
for(var i=0;i<allContacts.length;i++){if(allContacts[i].favourate){document.getElementById("star").classList.remove("d-none");favouratesBox+=`
                <div class="contact-card mb-3 p-3 my-bg-gray-100 rounded-3 bg-hover-amber-50 d-flex justify-content-between align-items-center cursor-pointer bg-hover-green-700">
                    <div class="d-flex gap-3 align-items-center">
                        <div class="contact-avatar icon-size p-4 d-flex align-items-center justify-content-center rounded-4 from-violet-600-to-indego-600 text-white fw-bold">
                            ${allContacts[i].name.charAt(0).toUpperCase()}
                        </div>
                        <div class="contact-name">
                            <h4 class="mb-2 h6 fw-bold my-text-black">${allContacts[i].name}</h4>
                            <p class="mb-0 fs-7 my-text-gray-500">${allContacts[i].phone}</p>
                        </div>
                    </div>
                    <div>
                        <a href="tel:${allContacts[i].phone}" class="btn btn-tel my-bg-green-200 my-text-green-700 rounded-3">
                            <i class="fa-solid fa-phone"></i>
                        </a>
                    </div>
                </div>`}}
favourateContactCards.innerHTML=favouratesBox}
function displayEmergencies(){var emergenciesBox="";if(countEmergencies()==0){emergenciesBox=`
            <div class="no-emergencies p-4">
                <p class="mb-0 fs-7 my-text-gray-500 text-center">No Emergencies Contacts Yet</p>
            </div>`;emergencyContactCards.innerHTML=emergenciesBox;return}
for(var i=0;i<allContacts.length;i++){if(allContacts[i].emergency){emergenciesBox+=`
            <div class="contact-card mb-3 p-3 my-bg-gray-100 rounded-3 bg-hover-red-50 d-flex justify-content-between align-items-center cursor-pointer bg-hover-red-600">
                <div class="d-flex gap-3 align-items-center">
                    <div class="contact-avatar icon-size p-4 d-flex align-items-center justify-content-center rounded-4 from-violet-600-to-indego-600 text-white fw-bold">
                        ${allContacts[i].name.charAt(0).toUpperCase()}
                    </div>
                    <div class="contact-name">
                        <h4 class="mb-2 h6 fw-bold my-text-black">${allContacts[i].name}</h4>
                        <p class="mb-0 fs-7 my-text-gray-500">${allContacts[i].phone}</p>
                    </div>
                </div>
                <div>
                    <a href="tel:${allContacts[i].phone}" class="btn btn-tel my-bg-red-200 my-text-red-600 rounded-3">
                        <i class="fa-solid fa-phone"></i>
                    </a>
                </div>
            </div>`}}
emergencyContactCards.innerHTML=emergenciesBox}
function favourateContact(index){if(allContacts[index].favourate){allContacts[index].favourate=!1}else{allContacts[index].favourate=!0}
displayContacts();displayFavorates();displayTotalContacts()}
function emergencyContact(index){if(allContacts[index].emergency){allContacts[index].emergency=!1}else{allContacts[index].emergency=!0}
displayContacts();displayEmergencies();displayTotalContacts()}
function displayContacts(element){if(allContacts.length!=0){var box="";var inputText=element?.value||"";for(var i=0;i<allContacts.length;i++){if(allContacts[i].name.toLowerCase().includes(inputText.toLowerCase())||allContacts[i].email.toLowerCase().includes(inputText.toLowerCase())||allContacts[i].phone.toLowerCase().includes(inputText.toLowerCase())){box+=`
                    <div class="col-md-6">
                            <div class="item my-bg-white rounded-4 w-100 general-box-shadow general-hover-shadow">
                                <div class="item-top p-3 d-flex gap-3 flex-column p-4">
                                    <div class="icon-name-phone d-flex gap-3 align-items-center">
                                        <div class="icon icon-size p-4 d-flex align-items-center justify-content-center rounded-4 from-violet-600-to-indego-600 text-white fw-bold position-relative">
                                            ${allContacts[i].name.charAt(0).toUpperCase()}
                                            ${checkStar(allContacts[i].favourate)}
                                            ${checkHeart(allContacts[i].emergency)}
                                        </div>
                                        <div class="name-phone">
                                            <h3 class="mb-0 fw-bold my-text-black h6">${allContacts[i].name}</h3>
                                            <p class="mb-0 fs-7 my-text-gray-500 d-flex gap-2 align-items-center">
                                                <span class="my-text-blue-500 my-bg-blue-100 icon-size d-flex align-items-center justify-content-center p-1 rounded">
                                                    <i class="fa-solid fa-phone fa-sm"></i>
                                                </span>
                                                <span>${allContacts[i].phone}</span>
                                            </p>
                                        </div>
                                    </div>
                                    ${checkEmail(allContacts[i].email)}
                                    ${checkAddress(allContacts[i].address)}
                                    <div class="group-emergency d-flex gap-3">
                                        ${checkGroup(allContacts[i].group)}
                                        ${checkEmergency(allContacts[i].emergency)}
                                    </div>
                                </div>
                                <div class="item-footer p-3 d-flex align-items-center justify-content-between">
                                    <div class="phone-email d-flex gap-3">
                                        <div class="bg-hover-green-200 rounded-3">
                                            <a href="tel:${allContacts[i].phone}" class="btn btn-tel my-bg-green-200 my-text-green-700 rounded-3">
                                                <i class="fa-solid fa-phone"></i>
                                            </a>
                                        </div>
                                        ${allContacts[i].email ? `<div class="bg-hover-indigo-200 rounded-3"><a href="mailto:${allContacts[i].email}" class="btn btn-email my-bg-indigo-200 my-text-indigo-500 rounded-3"><i class="fa-solid fa-envelope"></i></a></div>` : ""}
                                    </div>
                                    <div class="edit-contact d-flex align-items-center">
                                        <button class="btn btn-fav my-text-gray-400 cursor-pointer border-0" title="Favorite" onclick="favourateContact(${i})">
                                            <i class="fa-solid fa-star"></i>
                                        </button>
                                        <button class="btn btn-heart my-text-gray-400 cursor-pointer border-0" title="Emergency" onclick="emergencyContact(${i})">
                                            <i class="fa-solid fa-heart-pulse"></i>
                                        </button>
                                        <a class="btn btn-edit my-text-gray-500 bg-hover-indigo-200 rounded-3 border-0" onclick="editContact(${i})" id="editBtn" title="Edit">
                                            <i class="fa-solid fa-pen"></i>
                                        </a>
                                        <a class="btn btn-remove my-text-gray-500 bg-hover-red-200 rounded-3 border-0" onclick="deleteContact(${i})" title="Remove">
                                            <i class="fa-solid fa-trash"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                    </div>`}
if(box){rowData.innerHTML=box}else{rowData.innerHTML='<h3 class="text-center text-danger fw-bold">No Contacts Found!</h3>'}}}else{rowData.innerHTML='<h3 class="text-center text-danger fw-bold">No Contacts Yet!</h3>'}}
function deleteContact(index){Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",}).then((result)=>{if(result.isConfirmed){Swal.fire({title:"Deleted!",text:"Your file has been deleted.",icon:"success",});allContacts.splice(index,1);localStorage.setItem("contacts",JSON.stringify(allContacts));updateUI()}})}
function deleteAllContacts(){if(allContacts.length==0)return;Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",}).then((result)=>{if(result.isConfirmed){Swal.fire({title:"Deleted!",text:"All contacts have been deleted.",icon:"success",});allContacts=[];localStorage.setItem("contacts",JSON.stringify(allContacts));updateUI()}})}
function editContact(index){var myModal=new bootstrap.Modal(document.getElementById("exampleModalScrollable"));myModal.show();contactName.value=allContacts[index].name;contactPhone.value=allContacts[index].phone;contactEmail.value=allContacts[index].email;contactAddress.value=allContacts[index].address;contactGroup.value=allContacts[index].group;contactDescription.value=allContacts[index].description;contactEmergencyCheck.checked=allContacts[index].emergency;contactFavourateCheck.checked=allContacts[index].favourate;saveContact.classList.add("d-none");updateContact.classList.remove("d-none");updateContact.onclick=function(){var nameValid=validateAllInputs(contactName);var phoneValid=validateAllInputs(contactPhone);var emailValid=(contactEmail.value==""||validateAllInputs(contactEmail));if(contactName.value==""||contactPhone.value==""){Swal.fire({title:"Please fill all required fields",icon:"warning",});return}
if(!nameValid||!phoneValid||!emailValid){Swal.fire({title:"Please enter valid data",icon:"warning",});return}
if(checkRepeatedContact(contactPhone.value)&&contactPhone.value!=allContacts[index].phone){Swal.fire({title:"Contact already exists",icon:"warning",});return}
allContacts[index].name=contactName.value;allContacts[index].phone=contactPhone.value;allContacts[index].email=contactEmail.value;allContacts[index].address=contactAddress.value;allContacts[index].group=contactGroup.value;allContacts[index].description=contactDescription.value;allContacts[index].emergency=contactEmergencyCheck.checked;allContacts[index].favourate=contactFavourateCheck.checked;localStorage.setItem("contacts",JSON.stringify(allContacts));updateUI();updateContact.classList.add("d-none");saveContact.classList.remove("d-none");Swal.fire({title:"Updated Successfully",icon:"success",});var exampleModalScrollable=document.getElementById("exampleModalScrollable");var modal=bootstrap.Modal.getInstance(exampleModalScrollable);modal.hide()}}
function validateAllInputs(element){var text=element.value;var regex={contactName:/^[\p{L}\p{M}'\-\s]+$/u,contactPhone:/^^(002)?(\+2)?01[0125][0-9]{8}$/,phoneNumber:/^^(002)?(\+2)?01[0125][0-9]{8}$/,contactEmail:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,};var errors={contactName:document.getElementById("errorName"),contactPhone:document.getElementById("errorPhone"),phoneNumber:document.getElementById("errorPhoneQR"),contactEmail:document.getElementById("errorEmail"),};if(text==""){element.classList.remove("is-invalid");element.classList.remove("is-valid");errors[element.id].classList.add("d-none");return!1}
if(regex[element.id].test(text)){element.classList.remove("is-invalid");element.classList.add("is-valid");errors[element.id].classList.add("d-none");return!0}else{element.classList.remove("is-valid");element.classList.add("is-invalid");errors[element.id].classList.remove("d-none");return!1}}
var navImage=document.getElementById("navImage");var lightContainer=document.getElementById("lightContainer");var closeImage=document.getElementById("closeImage");navImage.addEventListener("click",function(){lightContainer.classList.toggle("d-none");console.log("clicked")});closeImage.addEventListener("click",function(){lightContainer.classList.add("d-none")})